# FountainAI Publishing Frontend and DNS Management Proposal

## Overview
We propose a new FountainAI service responsible for publishing Teatro-generated web content. The service will render and serve the static pages and interactive components produced by the [Teatro](https://github.com/Fountain-Coach/Teatro) system. In addition, it will manage DNS records via OpenAPI-driven providers starting with Hetzner DNS and later Amazon Route¬†53.

## Goals
1. **Web Publishing Frontend**
   - Serve Teatro output directly over HTTP using SwiftNIO.
   - Provide templates for hosting blogs or documentation generated by Teatro.
   - Integrate with the existing `FountainAiLauncher` so the frontend is supervised alongside other services.
2. **DNS Management Integration**
   - Implement the Hetzner DNS API based on [`Hetzner-DNS/hetzner_dns_openapi.yaml`](https://github.com/Fountain-Coach/codex-deployer/blob/main/Hetzner-DNS/hetzner_dns_openapi.yaml).
   - Generate a Swift client from the OpenAPI specification and add tests covering zone creation, record updates and deletion.
   - Design the DNS subsystem with a provider protocol so additional services can be plugged in.
3. **Preparation for Route¬†53**
   - Identify an OpenAPI description for Route¬†53 or craft one matching the required operations.
   - Extend the generator workflow to support multiple providers and produce a `Route53Client` following the same protocol.
   - Add integration tests once credentials for an AWS environment are available.

## Implementation Plan
1. **Service Target**
   - Create a new SwiftPM target `PublishingFrontend` under `Sources/`.
   - Use SwiftNIO's `HTTPServer` to deliver static files and dynamic Teatro views.
   - Expose configuration via YAML files under `Configuration/` specifying listen port, TLS settings and the path to Teatro content.
2. **DNS Provider Protocol**
   - Define `DNSProvider` with methods for `listZones`, `createRecord`, `updateRecord` and `deleteRecord`.
   - Generate `HetznerDNSClient` from the OpenAPI spec and implement the protocol.
   - Stubs for `Route53Client` will compile but return `501` until the spec is available.
3. **Testing**
   - Add `PublishingFrontendTests` that launch the server on a random port and confirm Teatro pages render.
   - Include unit tests for `HetznerDNSClient` using mocked HTTP responses to validate serialization and request paths.
   - Ensure `swift test` executes for both Linux and macOS.
4. **Continuous Deployment**
   - Update `FountainAiLauncher` to build and run the new target.
   - Document environment variables such as `DNS_PROVIDER` and provider-specific tokens in `docs/environment_variables.md`.
   - Provide a script to regenerate clients from OpenAPI specs whenever they change.
5. **Timeline**
   - **Week¬†1:** Scaffold the service target and initial server.
   - **Week¬†2:** Implement Hetzner DNS client and integration tests.
   - **Week¬†3:** Incorporate the DNS provider protocol and stub Route¬†53 client.
   - **Week¬†4:** Finalize documentation, ensure `swift build` and `swift test` pass and prepare a demo deployment.

This proposal sets the direction for a unified publishing and DNS management service within FountainAI.

---
¬© 2025 Contexter alias Benedikt Eickhoff üõ°Ô∏è All rights reserved.
