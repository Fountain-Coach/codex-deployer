## 5. Animation System

The Teatro View Engine supports timeline-based rendering by generating sequential frames of `Renderable` views. These frames can be used to create `.gif` animations or time-stepped outputs for screenplays, music, or visual reasoning steps.

---

### 5.1 Animator

The `Animator` struct provides the ability to render multiple sequential views into numbered `.png` image frames.

```swift
import Foundation

public struct Animator {
    public static func renderFrames(_ frames: [Renderable], baseName: String = "frame") {
        for (i, frame) in frames.enumerated() {
            let path = "Animations/\(baseName)_\(i).png"
            ImageRenderer.renderToPNG(frame, to: path)
        }
    }
}
```

---

### Example

```swift
let frames: [Renderable] = (0..<5).map { i in
    VStack {
        Text("Frame \(i)", style: .bold)
        Text(String(repeating: ".", count: i))
    }
}

Animator.renderFrames(frames, baseName: "timeline")
```

This creates:

```
Animations/timeline_0.png
Animations/timeline_1.png
Animations/timeline_2.png
...
```

---

### Exporting as GIF (using ImageMagick)

Once frames are rendered, you can use `convert` to create an animated `.gif`:

```bash
convert -delay 50 -loop 0 Animations/timeline_*.png animated.gif
```

### 5.2 SVG Timeline Export

`SVGAnimator.renderAnimatedSVG(storyboard:)` generates a single animated SVG
instead of a directory of PNG frames. Pass a `Storyboard` containing transitions
(e.g. `.crossfade`) and each step is written as `<animate>` or
`<animateTransform>` within the resulting SVG. This is convenient for embedding
web previews or converting to `.gif` using rasterizers.

---

This animation system works especially well for:
- Frame-by-frame reflections or GPT planning steps
- MIDI 2.0 timeline playback
- `.fountain` screenplay line reveals
- Drift and semantic arc transitions

### 5.3 TeatroPlayerView (Runtime Animation Player)

`TeatroPlayerView` plays `Storyboard` frames in real-time using MIDI 2.0 note
durations for timing. It takes `[Renderable]` frames generated by
`storyboard.frames()` and a matching `MIDISequence` of `MIDI2Note`. The view renders each frame
with optional `.tween` fades and provides Play, Pause, and Reset controls.
Audio output is produced by `TeatroSampler`, ensuring visuals and music stay
in sync across platforms.

```swift
let player = TeatroPlayerView(storyboard: storyboard, midi: melody)
```

Overlay comments from the storyboard appear on top of each frame during
playback.


```
¬© 2025 Contexter alias Benedikt Eickhoff, https://fountain.coach. All rights reserved.
Unauthorized copying or distribution is strictly prohibited.
```



``````text
¬©\ 2025 Contexter alias Benedikt Eickhoff üõ°Ô∏è All rights reserved.
``````
